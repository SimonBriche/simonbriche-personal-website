"use strict";(self.webpackChunkreact_cmp=self.webpackChunkreact_cmp||[]).push([[368],{368:function(e,t,n){n.r(t);var a=n(861),o=n(152),s=n(757),r=n.n(s),c=n(791),i=n(212),l=n(184);t.default=function(e){var t=e.bridgeEvent,n=(0,c.useState)(null),s=(0,o.Z)(n,2),d=s[0],u=s[1],f=(0,c.useState)(null),p=(0,o.Z)(f,2),h=p[0],m=p[1],x=(0,c.useState)(!1),v=(0,o.Z)(x,2),g=v[0],w=v[1],y=(0,c.useState)(!1),b=(0,o.Z)(y,2),j=b[0],N=b[1];(0,c.useEffect)((function(){(0,i.O6)("5")&&(0,i.KK)("3")?(0,a.Z)(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"{\n          portfolioSearchFields{\n            clients, types\n          }\n        }",e.next=3,fetch("".concat("https://site--server--pn9hc6z44glx.code.run","/graphql?query=").concat(encodeURIComponent("{\n          portfolioSearchFields{\n            clients, types\n          }\n        }")));case 3:return e.next=5,e.sent.json();case 5:t=e.sent,m(t.data.portfolioSearchFields),window.$(".selectfilter").selectpicker();case 8:case"end":return e.stop()}}),e)})))().catch((function(e){console.log("getSearchFields error",e)})):console.warn("Bootstrap 5 and jQuery 3 must be loaded to use GalleryFilter component")}),[]);var S=(0,c.useCallback)((function(e,n){(0,a.Z)(r().mark((function a(){var o,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return N(!0),w(!0),a.next=4,C(e,n||d);case 4:o=a.sent,s=new CustomEvent("onGalleryTilesEvent",{detail:{tiles:o.tiles,after:o.after,hasNextPage:o.hasNextPage,isTilesAppended:!!e}}),t.dispatchEvent(s),w(!1),n&&u(n);case 9:case"end":return a.stop()}}),a)})))().catch((function(e){return console.log(e)}))}),[t,d]);(0,c.useEffect)((function(){var e=function(e){e.detail&&e.detail.after?S(e.detail.after):S(null,(0,i.W7)(1,1e3))};return t.addEventListener("onShowMoreTilesEvent",e),function(){t.removeEventListener("onShowMoreTilesEvent",e)}}),[t,S]);var C=function(e,t){return new Promise((function(n,o){(0,a.Z)(r().mark((function a(){var s,c,i,l,d,u;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=[],c=window.$("#clients-search").val(),i=window.$("#projects-search").val(),l='orderBy:{sort:RAND, direction:ASC, seed:"'.concat(t,'"}'),c.length>0&&s.push('{field: "client", operator:IN, value:'.concat(JSON.stringify(c),"}")),i.length>0&&s.push('{field: "types", operator:IN, value:'.concat(JSON.stringify(i),"}")),(c.length>0||i.length>0)&&(l="orderBy:{sort:CLIENT, direction:ASC}"),d="{\n          portfolio(\n            first: 12\n            ".concat(l,"\n            ").concat(e?'after:"'.concat(e,'"'):"","\n            ").concat(s.length>0?"filtering:[".concat(s.join(","),"]"):"","\n          ){\n            data{id, name, client, pitch, description, thumbnail, types, images, technology_ids},\n            pageInfo{\n              endCursor,\n              hasNextPage\n            }\n          }\n        }"),a.next=10,fetch("".concat("https://site--server--pn9hc6z44glx.code.run","/graphql?query=").concat(encodeURIComponent(d)));case 10:return a.next=12,a.sent.json();case 12:(u=a.sent).data.portfolio.data?n({tiles:u.data.portfolio.data,after:u.data.portfolio.pageInfo?u.data.portfolio.pageInfo.endCursor:null,hasNextPage:u.data.portfolio.pageInfo?u.data.portfolio.pageInfo.hasNextPage:null}):o(new Error(u.errors));case 14:case"end":return a.stop()}}),a)})))().catch(o)}))};return(0,l.jsx)(l.Fragment,{children:h?(0,l.jsxs)("div",{id:"gallery-filters",className:"d-flex flex-column flex-sm-row justify-content-center",children:[(0,l.jsx)("select",{id:"clients-search",className:"selectfilter mb-3 mb-sm-0 mx-auto ms-sm-0 me-sm-3","data-style":"btn-soft","data-none-selected-text":"Tous les clients","data-actions-box":"true","data-select-all-text":"Cocher","data-deselect-all-text":"D\xe9cocher",multiple:!0,children:h.clients.map((function(e,t){return(0,l.jsx)("option",{children:e},"client-".concat(t))}))}),(0,l.jsx)("select",{id:"projects-search",className:"selectfilter mb-3 mb-sm-0 mx-auto ms-sm-0 me-sm-3","data-style":"btn-soft","data-none-selected-text":"Tous les projets","data-actions-box":"true","data-select-all-text":"Cocher","data-deselect-all-text":"D\xe9cocher",multiple:!0,children:h.types.map((function(e,t){return(0,l.jsx)("option",{children:e},"type-".concat(t))}))}),j&&(0,l.jsxs)("button",{onClick:function(){g||S(null,(0,i.W7)(1,1e3))},className:"btn btn-custom btn-soft text-red ".concat(g?"pending":""),disabled:g,children:[(0,l.jsx)("span",{className:"pending-spinner",children:(0,l.jsx)("i",{className:"fas fa-spinner fa-spin"})}),(0,l.jsx)("i",{className:"fas fa-search"})]})]}):(0,l.jsx)("div",{className:"cmp-loader",children:(0,l.jsxs)("div",{className:"lds-ring",children:[(0,l.jsx)("div",{}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{})]})})})}},212:function(e,t,n){n.d(t,{O6:function(){return o},KK:function(){return s},Fq:function(){return r},W7:function(){return c}});var a={isBootstrapAvailable:function(e){return!e||!!(window.bootstrap&&window.bootstrap.Modal&&window.bootstrap.Modal.VERSION)&&window.bootstrap.Modal.VERSION.localeCompare(e,void 0,{numeric:!0,sensitivity:"base"})>=0},isJQueryAvailable:function(e){return!e||!!(window.$&&window.$.fn&&window.$.fn.jquery)&&window.$.fn.jquery.localeCompare(e,void 0,{numeric:!0,sensitivity:"base"})>=0},lazyLoadImages:function(e){"loading"in HTMLImageElement.prototype?e.querySelectorAll("img.lazyload").forEach((function(e){e.onload=function(){this.classList&&this.classList.add("show")},e.src=e.dataset.src})):n.e(504).then(n.t.bind(n,504,23))},randomString:function(e){for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",a=e;a>0;--a)n+=t[Math.round(Math.random()*(t.length-1))];return n},randomBetween:function(e,t){return Math.ceil(t-Math.random()*(t-(e-1)))}},o=a.isBootstrapAvailable,s=a.isJQueryAvailable,r=a.lazyLoadImages,c=a.randomBetween}}]);
//# sourceMappingURL=368.31640b73.chunk.js.map